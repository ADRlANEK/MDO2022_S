pipeline {
    agent any
    
    stages {
        stage('build') {
            steps {
                sh 'docker build -t buildirssi . -f ITE/GCL04/SK403390/Lab05/DockerfileBuild'
		sh 'docker run --name tempContainer -dit --rm buildirssi'
		sh 'rm -r fe-text'
		sh 'docker cp tempContainer:irssi/build/src/fe-text .'
		sh 'docker kill tempContainer'
		sh 'ls'
            }
        }
        stage('test') {
            steps {
                sh 'docker build -t testirssi . -f ITE/GCL04/SK403390/Lab05/DockerfileTest'
		sh 'docker run testirssi'
            }
        }
	stage('deploy') {
	    steps {
		sh 'docker run --rm --name deployContainer2 -dit ubuntu'
		sh 'docker cp fe-text deployContainer2:.'
		sh 'docker kill deployContainer2'
		sh 'ls'
		sh 'ls fe-text'
	    }
	}
    }
}
