# Generated by Anaconda 36.16.2
# Generated by pykickstart v3.36
#version=F36
# Use graphical install
text

# Keyboard layouts
keyboard --vckeymap=us --xlayouts='us'
# System language
lang en_US.UTF-8

# Network information
network  --bootproto=dhcp --device=enp0s3 --ipv6=auto --activate
network  --hostname=lab09

# Repo
#url --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=fedora-$releasever&arch=x86_64
#repo --name=updates --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=updates-released-f$releasever&arch=x86_64


%packages
@^minimal-environment

%end

# Run the Setup Agent on first boot
firstboot --enable

# Generated using Blivet version 3.4.3
ignoredisk --only-use=sda
autopart
# Partition clearing information
clearpart --none --initlabel

# System timezone
timezone Europe/Warsaw --utc

# Root password
rootpw --iscrypted $y$j9T$2ArWkJVDB5n7JLprE0X9z.0A$qD8LS3JbUot.TMUOzdo4ETNLq6y3KIkMp4dxVOHeMF7
user --name=js --password=$y$j9T$ngUCa2qodD.cKWYxvaS44j8G$LiwC87F3lzXLdPbob6zKwtw/H.yJhmRQ6IZwk6y0UVB --iscrypted --gecos="js"

%post
mkdir jenkins
yum install -y docker
wget https://raw.githubusercontent.com/bsponge/gomodifytags/main/jenkins/example -O ./jenkins/example
wget https://raw.githubusercontent.com/bsponge/gomodifytags/main/jenkins/expected -O expected
wget https://raw.githubusercontent.com/bsponge/gomodifytags/main/Dockerfile-test-deploy -O Dockerfile-test-deploy

docker build -t deploy-test -f Dockerfile-test-deploy --build-arg image=bsponge/deployment-image:latest
docker run --name test-deployment test-deploy
docker logs test-deployment >> testoutput.log
diff testoutput.log jenkins/expected
%end
