pipeline {
	agent any
	stages {
		stage("Start") {
			steps {
				sh 'docker volume create vol'
          	  	git 'https://github.com/InzynieriaOprogramowaniaAGH/MDO2022_S.git'
                sh 'git checkout origin/KT401975'
				sh 'git pull'
			 	sh 'git config --global user.email kewin@tarnowski.biz ; git config --global user.name kawelos'
				sh 'cd ITE/GCL08/KT401975/Lab05/dockerfiles/buildfile ; docker build -t builder:latest .'
			}
		}
      	stage('Build') {
			agent {
			       docker {
			             image 'builder:latest'
			             args '--mount source=vol,target=/vol'
			       }
			 }
         	 steps {
				  sh 'ls -l'      
             }
		}
      	stage('Test') {
         	 steps {
			  sh 'cd ITE/GCL08/KT401975/Lab05/dockerfiles/testfile; docker build -t tester:latest .'
			 }
		}
     }
}